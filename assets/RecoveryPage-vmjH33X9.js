import{u as H,r,j as e,L as I,c as g}from"./index-BKxVh_Sp.js";import{H as M,F as q}from"./Footer-DDC3bt3I.js";import{S as D}from"./StatusModal-BSOdPNJr.js";import{u as F}from"./Azell_isologo-blanco-Ci4e3o7d.js";import"./index-y9CQuyF_.js";const K=()=>{const{t:s}=F(),C=H(),[t,j]=r.useState(1),[c,N]=r.useState(""),[m,S]=r.useState(""),[p,w]=r.useState(""),[b,R]=r.useState(""),[d,o]=r.useState(!1),[h,x]=r.useState(120),[O,f]=r.useState(!1),[z,E]=r.useState(0),[u,i]=r.useState({isOpen:!1,message:"",type:"info"}),[y,A]=r.useState(!1),[v,k]=r.useState(!1),L=()=>i(a=>({...a,isOpen:!1}));r.useEffect(()=>{let a;return t===2&&h>0?a=setInterval(()=>{x(n=>n-1)},1e3):t===2&&h===0&&f(!0),()=>clearInterval(a)},[t,h]);const P=a=>{const n=Math.floor(a/60),l=a%60;return`${n}:${l<10?"0":""}${l}`},B=async a=>{a.preventDefault(),o(!0);try{await g.getAuthRepository().sendRecoveryCode(c),j(2),x(120),f(!1)}catch(n){const l=n.response?.data?.message||s("auth.error_sending_code","Error al enviar el código");i({isOpen:!0,title:"Error",message:l,type:"error"})}finally{o(!1)}},_=async a=>{a.preventDefault(),o(!0);try{await g.getAuthRepository().validateRecoveryCode(c,m),j(3)}catch(n){const l=n.response?.data?.message||s("auth.invalid_code","Código inválido");i({isOpen:!0,title:"Error",message:l,type:"error"})}finally{o(!1)}},T=async()=>{if(z>=3){i({isOpen:!0,title:"Límite alcanzado",message:"Has superado el número máximo de intentos.",type:"error"});return}o(!0);try{await g.getAuthRepository().sendRecoveryCode(c),x(120),f(!1),E(a=>a+1),i({isOpen:!0,title:"Éxito",message:"Código reenviado.",type:"success"})}catch(a){const n=a.response?.data?.message||"Error al reenviar código";i({isOpen:!0,title:"Error",message:n,type:"error"})}finally{o(!1)}},V=async a=>{if(a.preventDefault(),!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(p)){i({isOpen:!0,title:"Contraseña inválida",message:"La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula, un número y un carácter especial.",type:"error"});return}if(p!==b){i({isOpen:!0,title:"Error",message:"Las contraseñas no coinciden.",type:"error"});return}o(!0);try{await g.getAuthRepository().resetPassword(c,m,p),i({isOpen:!0,title:"Éxito",message:"Contraseña restablecida correctamente. Ahora puedes iniciar sesión.",type:"success"})}catch(l){const $=l.response?.data?.message||"Error al restablecer contraseña";i({isOpen:!0,title:"Error",message:$,type:"error"})}finally{o(!1)}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(M,{}),e.jsxs("main",{className:"az-split-container",children:[e.jsx("div",{className:"az-info-panel",children:e.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"2rem"},children:e.jsxs("span",{style:{display:"inline-block",padding:"0.25rem 0.75rem",backgroundColor:"rgba(56, 212, 48, 0.1)",color:"var(--color-brand-green)",borderRadius:"100px",fontSize:"0.8rem",fontWeight:"600",marginBottom:"1rem"},children:["● ",s("auth.secure_access","Acceso seguro")]})}),e.jsx("h1",{className:"az-heading-lg",children:s("auth.scaling_business","Scaling Business.")}),e.jsx("p",{className:"az-text-desc",children:s("auth.description","Gestione su patrimonio con herramientas financieras de última generación diseñadas para el crecimiento.")}),e.jsxs("div",{className:"az-feature-grid",children:[e.jsxs("div",{className:"az-feature-card",children:[e.jsx("span",{className:"az-feature-title",children:s("auth.features.title1","Rendimiento pactado")}),e.jsx("p",{className:"az-feature-text",children:s("auth.features.desc1","Productos estructurados...")})]}),e.jsxs("div",{className:"az-feature-card",children:[e.jsx("span",{className:"az-feature-title",children:s("auth.features.title2","Movimientos trazables")}),e.jsx("p",{className:"az-feature-text",children:s("auth.features.desc2","Seguimiento detallado...")})]}),e.jsxs("div",{className:"az-feature-card",children:[e.jsx("span",{className:"az-feature-title",children:s("auth.features.title3","Operación auditable")}),e.jsx("p",{className:"az-feature-text",children:s("auth.features.desc3","Controles y registros...")})]}),e.jsxs("div",{className:"az-feature-card",children:[e.jsx("span",{className:"az-feature-title",children:s("auth.features.title4","Experiencia premium")}),e.jsx("p",{className:"az-feature-text",children:s("auth.features.desc4","Interfaz limpia...")})]})]})]})}),e.jsx("div",{className:"az-form-panel",children:e.jsxs("div",{className:"az-card",children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h2",{style:{fontSize:"1.5rem",margin:"0 0 0.5rem 0"},children:[t===1&&s("auth.recover_title","Recuperar contraseña"),t===2&&"Ingresa el código",t===3&&"Nueva contraseña"]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:0,fontSize:"0.9rem",lineHeight:"1.5"},children:[t===1&&s("auth.recover_desc","Ingresa tu correo y te enviaremos un código."),t===2&&`Hemos enviado un código a ${c}`,t===3&&"Crea una contraseña segura para tu cuenta"]})]}),t===1&&e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"az-label",children:s("auth.email","Correo electrónico")}),e.jsx("input",{type:"email",className:"az-input",placeholder:"user@example.com",value:c,onChange:a=>N(a.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"az-btn az-btn-primary",disabled:d,children:d?"Enviando...":"Enviar código"})]}),t===2&&e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"az-label",children:"Código de verificación"}),e.jsx("input",{type:"text",className:"az-input",placeholder:"12345678",value:m,onChange:a=>{const n=a.target.value.replace(/[^0-9]/g,"").slice(0,8);S(n)},required:!0,maxLength:8,style:{letterSpacing:"0.5em",textAlign:"center",fontSize:"1.2rem"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.85rem",marginTop:"0.5rem"},children:[e.jsxs("span",{style:{color:"var(--text-secondary)"},children:["Tiempo restante: ",P(h)]}),O&&z<3&&e.jsx("button",{type:"button",onClick:T,style:{background:"none",border:"none",color:"var(--accent-primary)",cursor:"pointer",padding:0},children:"Solicitar nuevo código"})]})]}),e.jsx("button",{type:"submit",className:"az-btn az-btn-primary",disabled:d||m.length!==8,children:d?"Verificando...":"Verificar código"})]}),t===3&&e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"az-label",children:"Nueva Contraseña"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:y?"text":"password",className:"az-input",value:p,onChange:a=>w(a.target.value),required:!0,style:{marginBottom:0,paddingRight:"5rem"}}),e.jsx("button",{type:"button",onClick:()=>A(!y),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",cursor:"pointer",color:"var(--text-secondary)",fontSize:"0.8rem"},children:y?"Ocultar":"Ver"})]}),e.jsxs("ul",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.5rem",paddingLeft:"1.2rem"},children:[e.jsx("li",{children:"Mínimo 8 caracteres"}),e.jsx("li",{children:"Al menos una mayúscula y una minúscula"}),e.jsx("li",{children:"Al menos un número y un caracter especial"})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"az-label",children:"Confirmar Contraseña"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:v?"text":"password",className:"az-input",value:b,onChange:a=>R(a.target.value),required:!0,style:{marginBottom:0,paddingRight:"5rem"}}),e.jsx("button",{type:"button",onClick:()=>k(!v),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",cursor:"pointer",color:"var(--text-secondary)",fontSize:"0.8rem"},children:v?"Ocultar":"Ver"})]})]}),e.jsx("button",{type:"submit",className:"az-btn az-btn-primary",disabled:d,children:d?"Actualizando...":"Actualizar contraseña"})]}),e.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:e.jsx(I,{to:"/login",className:"az-link",children:s("auth.back_login","Volver al inicio")})})]})})]}),e.jsx(q,{}),e.jsx(D,{isOpen:u.isOpen,onClose:()=>{L(),u.type==="success"&&t===3&&C("/login")},title:u.title,message:u.message,type:u.type})]})};export{K as RecoveryPage};
